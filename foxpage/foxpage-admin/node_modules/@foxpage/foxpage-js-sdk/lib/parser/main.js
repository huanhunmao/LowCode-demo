var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.parse = void 0;
const foxpage_core_1 = require("@foxpage/foxpage-core");
const foxpage_plugin_function_parse_1 = __importDefault(require("@foxpage/foxpage-plugin-function-parse"));
const api_1 = require("../api");
/**
 * parse
 * @param page page content
 * @param ctx render context
 * @returns parsed page content
 */
const parse = async (page, ctx) => {
    const parserInstance = foxpage_core_1.parser.getParser();
    if (!parserInstance) {
        await foxpage_core_1.parser.initParser({ hooks: { variable: (0, foxpage_plugin_function_parse_1.default)({ api: (0, api_1.getApis)() }).visitor } });
    }
    const parsed = await foxpage_core_1.parser.parse(page, ctx);
    return parsed;
};
exports.parse = parse;
