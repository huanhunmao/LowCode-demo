var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getSysVariables = exports.createSysVariable = void 0;
const lodash_1 = __importDefault(require("lodash"));
const shortid_1 = __importDefault(require("shortid"));
const content_1 = require("../content");
/**
 * create a sys variable by name
 * @param name variable name
 * @returns sys variable
 */
exports.createSysVariable = (name, props = {}) => {
    const variable = {
        id: 'builtin_variable_' + shortid_1.default(),
        schemas: [{ name: `__context:${name}`, type: 'data.sys', props }],
    };
    return variable;
};
/**
 * get sys variable name list
 * @param contentInfo content infos
 * @returns sys variable name list
 */
exports.getSysVariables = (contentInfo) => {
    let variables = [];
    Object.keys(contentInfo).forEach(key => {
        contentInfo[key].forEach(content => {
            var _a;
            const instance = new content_1.ContentDetailInstance(content);
            if ((_a = instance.sysVariables) === null || _a === void 0 ? void 0 : _a.length) {
                variables = lodash_1.default.union(variables, instance.sysVariables);
            }
        });
    });
    return variables;
};
